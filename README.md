# REST API для сервиса «Перевал» (SubmitData)

Данный API предназначен для приема и обработки данных о горных перевалах. Система позволяет пользователям отправлять информацию о маршрутах, координатах и прикреплять фотографии для последующей модерации.

---

## Методы API

### 1. Отправка новой записи
**Эндпоинт:** `POST /submitData/`  
Создает новую запись о перевале.

**Пример JSON-запроса:**
```json
{
  "beauty_title": "пер.",
  "title": "Пятисот",
  "other_titles": "Трисот",
  "connect": "",
  "add_time": "2024-01-01 12:00:00",
  "user": {
    "email": "test@example.com",
    "fam": "Иванов",
    "name": "Иван",
    "otc": "Иванович",
    "phone": "89001112233"
  },
  "coords": {
    "latitude": "45.3842",
    "longitude": "7.1525",
    "height": "1200"
  },
  "level": {
    "winter": "1A",
    "summer": "1B",
    "autumn": "1A",
    "spring": "1B"
  },
  "images": [
    {"data": "url_to_image_1", "title": "Седловина"},
    {"data": "url_to_image_2", "title": "Подъем"}
  ]
}
```
**Пример ответа (Успех 200):**
```json
{
  "status": 200,
  "message": "Отправлено успешно",
  "id": 42
}
```

### 2. Получение данных о перевале по ID
**Эндпоинт:** `GET /submitData/<id>/`  
Возвращает полную информацию об одном объекте.

**Варианты ответов:**  
200 OK: Возвращает JSON со всеми полями объекта.

404 Not Found: 
```json
{"message": "Запись <id> не найдена", "status": 404}
```

### 3. Получение данных о перевале по Email
**Эндпоинт:** `GET /submitData/?user_email=<email>`
Возвращает список всех перевалов, которые отправил пользователь с указанной почтой.

**Пример запроса:** `GET /submitData/?user_email=test@example.com`

### 4. Редактирование существующей записи
**Эндпоинт:** `PATCH /submitData/<id>/`
Позволяет отредактировать запись, если она находится в статусе new.

**Особенности работы:** 

Запрещенные поля: ФИО, email и номер телефона пользователя не подлежат изменению. Даже если они переданы в запросе, API их проигнорирует.
Проверка статуса: Если статус записи отличается от new, редактирование будет отклонено.
Обновление вложенных данных: Координаты и изображения обновляются (заменяются) полностью.

**Пример ответа:**

Успех:
```json
{"state": 1, "message": "Запись успешно обновлена"}
```
Ошибка (не тот статус): 
```json
{"state": 0, "message": "Нельзя редактировать запись в статусе pending"}
```
Ошибка (не найдено): 
```json
{"state": 0, "message": "Запись с номером id <id> не найдена."}
```

### Статусы модерации:
new - Новая запись. Доступна для редактирования методом PATCH.

checking - На модерации. Заблокирована для изменений.

accepted - Принята и опубликована